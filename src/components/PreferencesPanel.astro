---
import type { Lang } from "../i18n/i18n";
import { t } from "../i18n/i18n";
import { SOURCES } from "../../scripts/sources/index";

type Props = {
  lang: Lang;
};

const { lang } = Astro.props;
---

<section class="glass rounded-2xl p-5">
  <div class="flex items-center justify-between">
    <h2 class="m-0 text-sm font-semibold text-slate-950">{t(lang, "prefs.title")}</h2>
    <span class="rounded-full border border-slate-900/10 bg-white/50 px-2 py-1 text-[11px] text-slate-700">Local</span>
  </div>

  <div class="mt-3 grid gap-3">
    <label class="flex select-none items-center gap-2 text-sm text-slate-800">
      <input id="acg-only-followed" type="checkbox" class="size-4 accent-violet-600" />
      <span>{t(lang, "prefs.followOnly")}</span>
    </label>
    <label class="flex select-none items-center gap-2 text-sm text-slate-800">
      <input id="acg-hide-read" type="checkbox" class="size-4 accent-violet-600" />
      <span>{t(lang, "prefs.hideRead")}</span>
    </label>
  </div>

  <div class="mt-4">
    <div class="flex gap-2">
      <input
        id="acg-follow-input"
        class="w-full rounded-xl border border-slate-900/10 bg-white/60 px-3 py-2 text-xs text-slate-950 outline-none focus:border-slate-900/20 focus:bg-white/70"
        placeholder={t(lang, "prefs.followPlaceholder")}
      />
      <button
        type="button"
        id="acg-follow-add"
        class="glass rounded-xl px-3 py-2 text-xs font-medium text-slate-950 clickable"
      >
        {t(lang, "prefs.followAdd")}
      </button>
    </div>
    <div id="acg-follow-list" class="mt-2 flex flex-wrap gap-2"></div>
  </div>

  <div class="mt-4">
    <div class="flex gap-2">
      <input
        id="acg-block-input"
        class="w-full rounded-xl border border-slate-900/10 bg-white/60 px-3 py-2 text-xs text-slate-950 outline-none focus:border-slate-900/20 focus:bg-white/70"
        placeholder={t(lang, "prefs.blockPlaceholder")}
      />
      <button
        type="button"
        id="acg-block-add"
        class="rounded-xl border border-rose-600/20 bg-rose-500/10 px-3 py-2 text-xs font-medium text-rose-800 clickable"
      >
        {t(lang, "prefs.blockAdd")}
      </button>
    </div>
    <div id="acg-block-list" class="mt-2 flex flex-wrap gap-2"></div>
  </div>

  <details class="mt-4 rounded-2xl border border-slate-900/10 bg-white/45 p-3">
    <summary class="cursor-pointer select-none text-xs font-semibold text-slate-950">
      {t(lang, "prefs.sources")}
      <span class="ml-2 text-[11px] font-normal text-slate-600">({SOURCES.length})</span>
    </summary>
    <div class="mt-3 grid grid-cols-1 gap-2">
      {SOURCES.map((s) => (
        <label class="flex select-none items-center gap-2 text-xs text-slate-800">
          <input type="checkbox" class="size-4 accent-violet-600" data-source-toggle-id={s.id} />
          <span class="truncate" title={s.name}>
            {s.name}
          </span>
        </label>
      ))}
    </div>
    <div class="mt-3 flex flex-wrap gap-2">
      <button
        type="button"
        id="acg-sources-enable-all"
        class="glass rounded-xl px-3 py-2 text-xs font-medium text-slate-950 clickable"
      >
        {t(lang, "prefs.enableAllSources")}
      </button>
      <button
        type="button"
        id="acg-sources-disable-all"
        class="rounded-xl border border-rose-600/20 bg-rose-500/10 px-3 py-2 text-xs font-medium text-rose-800 clickable"
      >
        {t(lang, "prefs.disableAllSources")}
      </button>
    </div>
  </details>

  <p class="mt-3 text-xs leading-relaxed text-slate-600">{t(lang, "prefs.hint")}</p>
  <p id="acg-prefs-message" class="mt-2 hidden text-xs text-slate-700"></p>
</section>
