# why · evolution_v0_8_ui_category_global_search

## 背景
当前站点首页/分类页采用 Astro 静态渲染，将“最新一段”资讯直接输出为 HTML，以获得良好的首屏可见性与分享/SEO 友好度；同时在同一搜索框内提供“本页搜索 / 全站搜索”切换（全站搜索由 Web Worker + search-pack/posts.json 驱动，并使用虚拟列表保证流畅）。

## 发现的问题（Atomic Audit 摘要）
1) **分类页 HTML 体积偏大**
- Perf Budget 输出中，`/zh/c/anime/`、`/ja/c/anime/` 等分类页单页体积达到 ~800KB 量级，主要来自“静态渲染条目数较多（120）+ 卡片结构较完整”。
- 结果：移动端首屏下载/解析成本增加；构建输出总体的 `html/xml/json(core)` 预算压力上升（虽然仍在阈值内，但可优化空间明显）。

2) **无障碍入口仍可补强**
- 站点已有全局 `:focus-visible` 样式与键盘交互，但缺少“Skip to content（跳到主内容）”入口，键盘用户需要跨越长导航才能进入主体区域。

## 目标
- **更轻的分类页首屏**：降低分类页静态 HTML 体积与构建压力，同时不牺牲用户获取“全量内容”的能力。
- **更强的可访问性**：新增 Skip Link，并提供稳定的主内容锚点（`<main id="main">`）。
- **保持一致体验**：复用现有“全站搜索”能力，做到“一键切换到全站并自动套用分类过滤”。

## 非目标
- 不改变数据管线与来源抓取策略。
- 不引入重量级前端框架/运行时状态管理。
- 不将站点改为 SSR/后端服务模式。

## 成功标准（Definition of Done）
- 分类页静态渲染条目数下调后，`/zh/c/*` 与 `/ja/c/*` 的 HTML 体积显著下降（预算输出中 top files 的分类页项降低）。
- 分类页提供“全站 · 本分类”入口：点击后自动切换到全站搜索，并将搜索框填充为 `cat:<category>`（支持继续输入追加条件）。
- 新增 Skip Link：键盘 Tab 首次可聚焦到跳转链接，并正确跳到主内容区域。
- `npm run check`、`npm run build`、`npm run budget` 全部通过。

