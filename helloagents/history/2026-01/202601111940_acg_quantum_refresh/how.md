# 技术设计: ACG Quantum Refresh

## 技术方案
### 核心技术
- Astro + TypeScript + Tailwind CSS
- 纯前端派生指标与本地偏好存储
- 无新增第三方后端或外部服务

### 实现要点
- 派生指标层（Pulse/阅读时长/去重键/时间窗）：在构建阶段计算并注入到页面数据与 data 属性
- 过滤与排序：前端统一过滤管线，新增时间透镜/稳定来源/去重视图/热度排序
- 来源健康度：使用 status.json 的来源状态生成健康度等级与颜色映射
- UI 体系：统一视觉变量、分层背景、可降级动效与可访问性友好样式
- 性能：优化虚拟列表阈值、懒加载图像、降低重排与动画成本

## 架构设计
维持现有“脚本抓取 → 生成数据 → Astro 静态构建 → 客户端本地交互”的核心架构，不引入新的运行时依赖与服务。

## 架构决策 ADR
### ADR-20260111-01: 派生指标在构建期生成
**上下文:** 热度与去重等指标若在客户端实时计算，会增加首次渲染成本与交互延迟。  
**决策:** 在 Astro 构建阶段生成派生指标，并通过 data 属性与组件 props 下发到前端。  
**理由:** 降低运行时计算量，提高首屏性能，避免重复计算。  
**替代方案:** 客户端按需计算 → 拒绝原因: 计算成本高、影响交互一致性。  
**影响:** 构建阶段稍有计算开销，但可控，且不影响核心数据协议。

## 安全与性能
- **安全:** 不新增外部请求；保持 safe-url 校验与本地存储隔离
- **性能:** 控制 DOM 复杂度、减少动画层级、使用 content-visibility 与 lazy loading

## 测试与部署
- **测试:** 扩充单元测试覆盖派生指标与筛选逻辑
- **部署:** 维持现有 GitHub Actions 部署流程，无需额外步骤
